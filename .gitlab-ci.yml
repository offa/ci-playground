image: docker:latest

variables:
  DOCKER_DRIVER: overlay2
  DEPLOY_REGISTRY: ${CI_REGISTRY_IMAGE}/experimental

services:
  - docker:dind


before_script:
  - docker info
  - docker login -u gitlab-ci-token -p ${CI_JOB_TOKEN} ${CI_REGISTRY}
  - apk add --update git
  - git clone --depth=1 https://github.com/offa/stm32-eth stm32-eth
  - cd stm32-eth


gcc-7:
  script:
    - pwd
    - ls *
    - script/build-image.sh gcc-7 docker/x86

gcc-6:
  script:
    - pwd
    - script/build-image.sh gcc-6 docker/x86

clang-5:
  script:
    - pwd
    - script/build-image.sh clang-5 docker/x86

clang-4:
  script:
    - pwd
    - script/build-image.sh clang-4 docker/x86

arm-none-eabi-gcc:
  script:
    - pwd
    - script/build-image.sh arm-none-eabi-gcc docker/arm

